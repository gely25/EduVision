{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}EduVision{% endblock %}</title>

  <!-- 🎨 Estilos globales -->
  <link rel="stylesheet" href="{% static 'css/base.css' %}">

  {% block extra_css %}{% endblock %}

  <!-- Tipografía moderna -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Íconos -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
</head>

<body>
  <!-- ====== HEADER GLOBAL ====== -->
  <header class="ev-header">
    <div class="ev-container ev-header-inner">

      <!-- 🔹 LOGO (redirige según estado de sesión) -->
      {% if request.user.is_authenticated %}
        <a class="brand" href="{% url 'dashboard' %}">
          <i class="fa-solid fa-camera"></i> EduVision
        </a>
      {% else %}
        <a class="brand" href="{% url 'home' %}">
          <i class="fa-solid fa-camera"></i> EduVision
        </a>
      {% endif %}

      <!-- 🔹 MENÚ PRINCIPAL -->
      <nav class="main-nav">
        {% if request.user.is_authenticated %}
          <a href="{% url 'dashboard' %}">Inicio</a>
          <a href="{% url 'flashcards_page' %}">Flashcards</a>
          <a href="{% url 'start_view' %}">Juego</a>
          <a href="#">Clasificación</a>

          <!-- 👤 MENÚ DE USUARIO -->
          <div class="user-dropdown">
            <button class="user-pill" id="userDropdownBtn">
              <span class="avatar">{{ request.user.username|slice:":1" }}</span>
              <span class="username">{{ request.user.username }}</span>
              <i class="fa-solid fa-chevron-down"></i>
            </button>

            <div class="dropdown-menu" id="userDropdownMenu">
              <form id="logout-form" method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button type="submit" class="dropdown-item">
                  <i class="fa-solid fa-right-from-bracket"></i> Cerrar sesión
                </button>
              </form>
            </div>
          </div>

        {% else %}
          <!-- 🔒 Usuario no autenticado -->
          <a class="btn ghost" href="{% url 'login' %}">
            <i class="fa-solid fa-user"></i> Iniciar sesión
          </a>
          <a class="btn ghost" href="{% url 'signup' %}">
            <i class="fa-solid fa-user-plus"></i> Registrarse
          </a>
        {% endif %}
      </nav>
    </div>
  </header>


  <!-- ====== CONTENIDO ====== -->
  <main class="ev-main">
    <div class="ev-container">
      {% if messages %}
        <ul class="messages">
          {% for message in messages %}
            <li class="msg {{ message.tags }}">{{ message }}</li>
          {% endfor %}
        </ul>
      {% endif %}
      {% block content %}{% endblock %}
    </div>
  </main>


  <!-- ====== FOOTER ====== -->
  <footer class="ev-footer">
    <div class="ev-container">© {{ now|date:'Y' }} EduVision</div>
  </footer>


  <!-- ====== JS GLOBAL ====== -->
  <script src="{% static 'js/auth.js' %}"></script>
  {% block extra_js %}{% endblock %}
</body>
</html>
