{% extends 'base.html' %}
{% load static %}

{% block title %}Inicio Â· EduVision{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
{% endblock %}

{% block content %}
<section class="hero">
  <h1>Aprende <strong>InglÃ©s</strong> con <strong>TecnologÃ­a Visual</strong></h1>
  <p>Sistema de EducaciÃ³n con reconocimiento de objetos, gestos y retroalimentaciÃ³n inmediata para un aprendizaje divertido y efectivo.</p>

  <div class="welcome-card">
    <h2>Â¡Hola, {{ nombre|title }}! ğŸ‘‹</h2>
    <p>Comencemos tu camino de aprendizaje</p>

    <div class="stats">
      <div>
        <h3 id="aprendidasCount">{{ aprendidas|default:"0" }}</h3>
        <p>Palabras Aprendidas</p>
      </div>
      <div>
        <h3 id="pendientesCount">{{ pendientes|default:"0" }}</h3>
        <p>Palabras Pendientes</p>
      </div>
    </div>

    <a href="{% url 'tm_live_view' %}" class="btn-primary">
      <i class="fa-solid fa-camera"></i> COMENZAR
    </a>
  </div>
</section>

<section class="learning-options">
  <h2>Â¿QuÃ© quieres hacer hoy?</h2>

  <div class="options-grid">
    <!-- ğŸ”¹ OpciÃ³n 1 -->
    <div class="option-card">
      <i class="fa-solid fa-camera icon"></i>
      <h3>Reconocimiento de Objetos</h3>
      <p>Usa tu cÃ¡mara para identificar objetos en tiempo real y aprende su nombre en inglÃ©s al instante con pronunciaciÃ³n nativa.</p>
      <a href="{% url 'tm_live_view' %}" class="btn-secondary">Iniciar Ahora â†’</a>
    </div>

    <!-- ğŸ”¹ OpciÃ³n 2 -->
    <div class="option-card">
      <i class="fa-solid fa-clone icon"></i>
      <h3>Flashcards Inteligentes</h3>
      <p>Sistema de tarjetas adaptativo que se ajusta a tu ritmo de aprendizaje y refuerza las palabras que mÃ¡s necesitas practicar.</p>
      <a href="{% url 'flashcards_page' %}" class="btn-secondary">Repasar Ahora â†’</a>
    </div>

    <!-- ğŸ”¹ OpciÃ³n 3 -->
    <div class="option-card">
      <i class="fa-solid fa-gamepad icon"></i>
      <h3>Juego Interactivo</h3>
      <p>Participa en un juego dinÃ¡mico donde se te pide mostrar objetos en inglÃ©s. Usa tu cÃ¡mara para responder y recibe retroalimentaciÃ³n instantÃ¡nea.</p>
      <a href="{% url 'start_view' %}" class="btn-secondary">Jugar Ahora â†’</a>
    </div>
  </div>
</section>

<script>
  // ğŸ”„ Actualiza los contadores en tiempo real desde el backend
  async function updateDashboardCounters() {
    try {
      const res = await fetch("{% url 'dashboard_summary_api' %}");
      const data = await res.json();

      if (data.counters) {
        document.querySelector("#aprendidasCount").innerText = data.counters.aprendidas;
        document.querySelector("#pendientesCount").innerText = data.counters.pendientes;
      }
    } catch (err) {
      console.error("Error al actualizar los contadores:", err);
    }
  }

  // Se ejecuta cada 5 segundos automÃ¡ticamente
  setInterval(updateDashboardCounters, 5000);
</script>
{% endblock %}
